<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Elevate Fitness Tracker</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    body {
      font-family: 'Calibri', Arial, sans-serif;
      background: #f5f5f5;
      padding: 0;
      margin: 0;
    }
    .excel-container {
      max-width: 1200px;
      margin: 20px auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .excel-header {
      background: #006644; /* Elevate green */
      color: white;
      padding: 20px;
      text-align: center;
      border-bottom: 4px solid #cfa52a; /* Elevate gold */
    }
    .excel-tabs {
      display: flex;
      background: #e7e6e6;
      border-bottom: 2px solid #ccc;
    }
    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      font-weight: bold;
      background: #f2f2f2;
      cursor: pointer;
      transition: background 0.3s;
    }
    .tab.active {
      background: white;
      border-bottom: 3px solid #006644;
      color: #006644;
    }
    .sheet-content { display: none; padding: 20px; }
    .sheet-content.active { display: block; }
    .section-title {
      background: #006644;
      color: white;
      padding: 10px;
      font-weight: bold;
      text-align: center;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .calc-card {
      background: #fdfdfd;
      border: 2px solid #cfa52a;
      border-radius: 6px;
      padding: 15px;
      margin: 10px 0;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
    }
    .calc-card span {
      display: block;
      font-size: 28px;
      color: #006644;
      margin-top: 5px;
    }
    .input-row {
      margin: 10px 0;
    }
    .input-row label {
      display: inline-block;
      width: 120px;
      font-weight: bold;
    }
    .input-row input, .input-row select {
      padding: 5px;
      font-size: 14px;
    }
    canvas { max-width: 400px; margin: 20px auto; display: block; }
  </style>
</head>
<body>
  <div class="excel-container">
    <div class="excel-header">
      <h1>üèãÔ∏è Elevate Fitness Tracker</h1>
    </div>

    <div class="excel-tabs">
      <div class="tab active" onclick="switchTab('bmr')">BMR</div>
      <div class="tab" onclick="switchTab('tdee')">TDEE</div>
      <div class="tab" onclick="switchTab('bmi')">BMI</div>
      <div class="tab" onclick="switchTab('bodycomp')">Body Comp</div>
      <div class="tab" onclick="switchTab('macros')">Macros</div>
    </div>

    <!-- BMR TAB -->
    <div id="bmr" class="sheet-content active">
      <div class="section-title">Basal Metabolic Rate (BMR)</div>
      <div class="input-row">
        <label>Age:</label>
        <input type="number" id="age" min="16" max="100" onchange="calculateAll()">
      </div>
      <div class="input-row">
        <label>Gender:</label>
        <select id="gender" onchange="calculateAll()">
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
      <div class="input-row">
        <label>Height (cm):</label>
        <input type="number" id="height" min="100" max="250" onchange="calculateAll()">
      </div>
      <div class="input-row">
        <label>Weight (kg):</label>
        <input type="number" id="weight" min="30" max="300" step="0.1" onchange="calculateAll()">
      </div>
      <div class="calc-card">
        BMR Result
        <span id="bmrResult">0</span> cal/day
      </div>
    </div>

    <!-- TDEE TAB -->
    <div id="tdee" class="sheet-content">
      <div class="section-title">Total Daily Energy Expenditure (TDEE)</div>
      <div class="input-row">
        <label>Activity Level:</label>
        <select id="activityLevel" onchange="calculateAll()">
          <option value="1.2">Sedentary</option>
          <option value="1.375">Light</option>
          <option value="1.55">Moderate</option>
          <option value="1.725">Active</option>
          <option value="1.9">Very Active</option>
        </select>
      </div>
      <div class="calc-card">
        TDEE
        <span id="tdeeResult">0</span> cal/day
      </div>
      <div class="calc-card">
        Target Calories (adjusted)
        <span id="targetCalories">0</span> cal/day
      </div>
    </div>

    <!-- BMI TAB -->
    <div id="bmi" class="sheet-content">
      <div class="section-title">Body Mass Index (BMI)</div>
      <div class="calc-card">
        BMI
        <span id="bmiResult">0</span> kg/m¬≤
      </div>
      <div class="calc-card">
        Category
        <span id="bmiCategory">Normal</span>
      </div>
    </div>

    <!-- BODY COMP TAB -->
    <div id="bodycomp" class="sheet-content">
      <div class="section-title">Body Composition</div>
      <div class="input-row">
        <label>Body Fat %:</label>
        <input type="number" id="bodyFat" min="5" max="50" step="0.1" onchange="calculateAll()">
      </div>
      <div class="calc-card">
        Lean Body Mass
        <span id="leanMass">0</span> kg
      </div>
      <div class="calc-card">
        Fat Mass
        <span id="fatMass">0</span> kg
      </div>
    </div>

    <!-- MACROS TAB -->
    <div id="macros" class="sheet-content">
      <div class="section-title">Macro Planning</div>
      <div class="input-row">
        <label>Protein %:</label>
        <input type="number" id="proteinPercent" value="30" onchange="updateMacros()"> %
      </div>
      <div class="input-row">
        <label>Fat %:</label>
        <input type="number" id="fatPercent" value="30" onchange="updateMacros()"> %
      </div>
      <div class="input-row">
        <label>Carbs %:</label>
        <input type="number" id="carbPercent" value="40" readonly> %
      </div>
      <canvas id="macroChart"></canvas>
    </div>
  </div>

  <script>
    // Tab switching
    function switchTab(tabId) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.sheet-content').forEach(s => s.classList.remove('active'));
      document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }

    function calculateAll() {
      const age = parseInt(document.getElementById('age').value) || 0;
      const gender = document.getElementById('gender').value;
      const height = parseFloat(document.getElementById('height').value) || 0;
      const weight = parseFloat(document.getElementById('weight').value) || 0;
      const activity = parseFloat(document.getElementById('activityLevel').value) || 1.2;
      const bodyFat = parseFloat(document.getElementById('bodyFat').value) || 0;

      // BMR
      let bmr = 0;
      if (gender === "male") {
        bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
      } else {
        bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
      }
      document.getElementById('bmrResult').textContent = bmr.toFixed(0);

      // TDEE
      const tdee = bmr * activity;
      document.getElementById('tdeeResult').textContent = tdee.toFixed(0);

      // Target Calories (example: no adjustment here, just same as TDEE)
      document.getElementById('targetCalories').textContent = tdee.toFixed(0);

      // BMI
      const bmi = (weight / ((height/100) ** 2)) || 0;
      document.getElementById('bmiResult').textContent = bmi.toFixed(1);
      let bmiCat = "Normal";
      if (bmi < 18.5) bmiCat = "Underweight";
      else if (bmi < 25) bmiCat = "Normal";
      else if (bmi < 30) bmiCat = "Overweight";
      else bmiCat = "Obese";
      document.getElementById('bmiCategory').textContent = bmiCat;

      // Body Comp
      const lean = weight * (1 - (bodyFat/100));
      const fat = weight - lean;
      document.getElementById('leanMass').textContent = lean.toFixed(1);
      document.getElementById('fatMass').textContent = fat.toFixed(1);
    }

    // Macro Chart
    const ctx = document.getElementById('macroChart').getContext('2d');
    const macroChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: ['Protein', 'Fat', 'Carbs'],
        datasets: [{
          data: [30, 30, 40],
          backgroundColor: ['#006644', '#cfa52a', '#888']
        }]
      }
    });

    function updateMacros() {
      let protein = parseInt(document.getElementById('proteinPercent').value) || 0;
      let fat = parseInt(document.getElementById('fatPercent').value) || 0;
      let carbs = 100 - (protein + fat);
      if (carbs < 0) carbs = 0;
      document.getElementById('carbPercent').value = carbs;
      macroChart.data.datasets[0].data = [protein, fat, carbs];
      macroChart.update();
    }

    calculateAll();
  </script>
</body>
</html>
