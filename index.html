<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Elevate Fitness Tracker</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    body {font-family: 'Calibri', Arial, sans-serif; background: #f5f5f5; padding: 20px;}
    .excel-container {max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden;}
    .excel-header {background: #2E75B6; color: white; padding: 20px; text-align: center;}
    .excel-tabs {background: #E7E6E6; display: flex; border-bottom: 2px solid #ccc;}
    .tab {padding: 12px 24px; background: #F2F2F2; border-right: 1px solid #ccc; cursor: pointer; font-weight: bold;}
    .tab.active {background: white; border-bottom: 2px solid white;}
    .sheet-content {display: none; padding: 20px;}
    .sheet-content.active {display: block;}
    .section-title {background: #4472C4; color: white; padding: 10px; font-weight: bold; text-align: center; margin: 20px 0; border-radius: 4px;}
    .excel-grid {display: grid; grid-template-columns: 150px 200px 150px 200px 150px 200px; gap: 2px; background: #E0E0E0; border: 2px solid #A6A6A6; margin-bottom: 30px;}
    .grid-cell {background: white; border: 1px solid #D4D4D4; padding: 8px; font-size: 11px; min-height: 25px; display: flex; align-items: center;}
    .header-cell {background: #4472C4; color: white; font-weight: bold; text-align: center; justify-content: center;}
    .label-cell {background: #D9E2F3; font-weight: bold; border-right: 2px solid #4472C4;}
    .input-cell input, .input-cell select {width: 100%; border: none; background: transparent; font-size: 11px; padding: 2px;}
    .formula-cell {background: #E2EFDA; font-weight: bold; color: #0D5F0D;}
    .result-cell {background: #FFF2CC; font-weight: bold; color: #7F6000; text-align: center; justify-content: center;}
    .chart-container {background: white; padding: 20px; margin: 20px 0; border: 1px solid #D4D4D4; border-radius: 4px;}
    .export-buttons {padding: 20px; text-align: center;}
    .excel-button {background: #217346; color: white; border: none; padding: 12px 24px; margin: 0 10px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 14px;}
    .excel-button:hover {background: #1B5E20;}
  </style>
</head>
<body>
  <div class="excel-container">
    <div class="excel-header">
      <h1>üèãÔ∏è Elevate Fitness Tracker</h1>
      <p>Professional Excel-Style Client Management System</p>
    </div>

    <!-- TABS -->
    <div class="excel-tabs">
      <div class="tab active" onclick="switchTab('bmr')">BMR</div>
      <div class="tab" onclick="switchTab('tdee')">TDEE</div>
      <div class="tab" onclick="switchTab('bmi')">BMI</div>
      <div class="tab" onclick="switchTab('macros')">Macros</div>
      <div class="tab" onclick="switchTab('progress')">Progress</div>
    </div>

    <!-- BMR TAB -->
    <div id="bmr" class="sheet-content active">
      <div class="section-title">üî• Metabolic Calculations</div>
      <div class="excel-grid">
        <div class="grid-cell header-cell">CALCULATION</div>
        <div class="grid-cell header-cell">RESULT</div>
        <div class="grid-cell header-cell">UNIT</div>
        <div class="grid-cell label-cell">BMR</div>
        <div class="grid-cell result-cell" id="bmrResult">0</div>
        <div class="grid-cell">kcal/day</div>
      </div>
    </div>

    <!-- TDEE TAB -->
    <div id="tdee" class="sheet-content">
      <div class="section-title">üî• Total Daily Energy</div>
      <div class="excel-grid">
        <div class="grid-cell header-cell">CALCULATION</div>
        <div class="grid-cell header-cell">RESULT</div>
        <div class="grid-cell header-cell">UNIT</div>
        <div class="grid-cell label-cell">TDEE</div>
        <div class="grid-cell result-cell" id="tdeeResult">0</div>
        <div class="grid-cell">kcal/day</div>
      </div>
    </div>

    <!-- BMI TAB -->
    <div id="bmi" class="sheet-content">
      <div class="section-title">üî• Body Mass Index</div>
      <div class="excel-grid">
        <div class="grid-cell header-cell">CALCULATION</div>
        <div class="grid-cell header-cell">RESULT</div>
        <div class="grid-cell header-cell">UNIT</div>
        <div class="grid-cell label-cell">BMI</div>
        <div class="grid-cell result-cell" id="bmiResult">0</div>
        <div class="grid-cell">kg/m¬≤</div>
      </div>
    </div>

    <!-- MACROS TAB -->
    <div id="macros" class="sheet-content">
      <div class="section-title">Macro Nutrient Planning</div>
      <div class="excel-grid">
        <div class="grid-cell header-cell">MACRO</div>
        <div class="grid-cell header-cell">PERCENT</div>
        <div class="grid-cell header-cell">GRAMS</div>
        <div class="grid-cell label-cell">Protein</div>
        <div class="grid-cell input-cell"><input type="number" id="proteinPercent" value="30" min="15" max="50" onchange="updateMacros()">%</div>
        <div class="grid-cell result-cell" id="proteinGrams">0</div>
        <div class="grid-cell label-cell">Carbs</div>
        <div class="grid-cell input-cell"><input type="number" id="carbPercent" value="40" min="20" max="65" onchange="updateMacros()">%</div>
        <div class="grid-cell result-cell" id="carbGrams">0</div>
        <div class="grid-cell label-cell">Fats</div>
        <div class="grid-cell input-cell"><input type="number" id="fatPercent" value="30" min="15" max="50" onchange="updateMacros()">%</div>
        <div class="grid-cell result-cell" id="fatGrams">0</div>
      </div>
      <div class="chart-container">
        <canvas id="macroChart"></canvas>
      </div>
    </div>

    <!-- PROGRESS TAB -->
    <div id="progress" class="sheet-content">
      <div class="section-title">Progress Tracking (Weight Only)</div>
      <input type="number" id="weightInput" placeholder="Enter weight (kg)">
      <button onclick="saveWeight()">Save</button>
      <table class="excel-grid">
        <div id="weightHistory"></div>
      </table>
      <div class="chart-container">
        <canvas id="weightChart"></canvas>
      </div>
    </div>

    <!-- EXPORT BUTTON -->
    <div class="export-buttons">
      <button class="excel-button" onclick="exportData()">üìß Export & Email</button>
    </div>
  </div>

<script>
function switchTab(tabId){
  document.querySelectorAll(".sheet-content").forEach(el=>el.classList.remove("active"));
  document.querySelectorAll(".tab").forEach(el=>el.classList.remove("active"));
  document.getElementById(tabId).classList.add("active");
  event.target.classList.add("active");
}

// Macro Chart
let macroChart = new Chart(document.getElementById("macroChart"), {
  type: "pie",
  data: {labels:["Protein","Carbs","Fats"], datasets:[{data:[30,40,30], backgroundColor:["#4caf50","#2196f3","#ff9800"]}]},
  options: {plugins:{legend:{position:"bottom"}}}
});
function updateMacros(){
  let p = parseInt(document.getElementById("proteinPercent").value)||0;
  let c = parseInt(document.getElementById("carbPercent").value)||0;
  let f = parseInt(document.getElementById("fatPercent").value)||0;
  let total = p+c+f;
  if(total!==100){ f = 100-(p+c); document.getElementById("fatPercent").value=f; }
  macroChart.data.datasets[0].data=[p,c,f];
  macroChart.update();
}

// Weight Log
let weightLog = JSON.parse(localStorage.getItem("weightLog"))||[];
let weightChart = new Chart(document.getElementById("weightChart"), {
  type:"line", data:{labels:weightLog.map(e=>e.date), datasets:[{label:"Weight (kg)", data:weightLog.map(e=>e.weight), borderColor:"#2E75B6"}]}
});
function saveWeight(){
  let w = document.getElementById("weightInput").value;
  if(!w) return;
  let entry={date:new Date().toLocaleDateString(), weight:w};
  weightLog.push(entry);
  localStorage.setItem("weightLog",JSON.stringify(weightLog));
  renderHistory();
  weightChart.data.labels.push(entry.date);
  weightChart.data.datasets[0].data.push(w);
  weightChart.update();
}
function renderHistory(){
  document.getElementById("weightHistory").innerHTML=weightLog.map(e=>`<div>${e.date}: ${e.weight} kg</div>`).join("");
}
renderHistory();

// Export Data
function exportData() {
  let summary = "Elevate Tracker Export\n\n";
  summary += "BMR: "+document.getElementById("bmrResult").innerText+" kcal\n";
  summary += "TDEE: "+document.getElementById("tdeeResult").innerText+" kcal\n";
  summary += "BMI: "+document.getElementById("bmiResult").innerText+"\n\n";
  summary += "Protein: "+document.getElementById("proteinGrams").innerText+" g\n";
  summary += "Carbs: "+document.getElementById("carbGrams").innerText+" g\n";
  summary += "Fats: "+document.getElementById("fatGrams").innerText+" g\n\n";
  summary += "Weight Log:\n";
  weightLog.forEach(e=>summary+=e.date+" ‚Äî "+e.weight+" kg\n");
  let subject = encodeURIComponent("Elevate Tracker Export");
  let body = encodeURIComponent(summary);
  window.location.href="mailto:?subject="+subject+"&body="+body;
}
</script>
</body>
</html>
